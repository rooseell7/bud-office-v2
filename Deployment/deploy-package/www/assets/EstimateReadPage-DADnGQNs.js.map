{"version":3,"file":"EstimateReadPage-DADnGQNs.js","sources":["../../src/pages/estimate/EstimateReadPage.tsx"],"sourcesContent":["/**\r\n * Read-only view of KP — PDF-like layout, all stages, print.\r\n * NO Sheet/Grid imports — static tables only.\r\n */\r\n\r\nimport React, { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate, useParams, useLocation } from 'react-router-dom';\r\nimport { Box, Button, Typography } from '@mui/material';\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\nimport PrintIcon from '@mui/icons-material/Print';\r\nimport {\r\n  getDocumentWithStages,\r\n  getSheetByDocKey,\r\n  buildDocKey,\r\n  type EstimateStage,\r\n} from '../../api/estimates';\r\nimport { worksSheetColumnHeaders } from '../../sheet/configs/worksSheetConfig';\r\nimport { materialsSheetColumnHeaders } from '../../sheet/configs/materialsSheetConfig';\r\nimport { W_COL } from '../../sheet/configs/worksSheetConfig';\r\nimport { M_COL } from '../../sheet/configs/materialsSheetConfig';\r\nimport { computeSheetTotals, formatUaMoney, formatPercent } from '../../sheet/utils/computeTotals';\r\nimport { uaLocale } from '../../sheet/configs/types';\r\n\r\ntype SheetSnapshot = { values?: string[][]; rawValues?: string[][]; rowCount?: number; colCount?: number };\r\n\r\nfunction getValues(snap: SheetSnapshot | null): string[][] {\r\n  if (!snap) return [];\r\n  const src = snap.values ?? snap.rawValues ?? [];\r\n  return src.map((row) => [...(row ?? [])]);\r\n}\r\n\r\nexport const EstimateReadPage: React.FC = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const loc = useLocation();\r\n  const estimateId = id ? parseInt(id, 10) : NaN;\r\n  const validId = Number.isFinite(estimateId) && estimateId > 0 ? estimateId : null;\r\n\r\n  const [doc, setDoc] = useState<Awaited<ReturnType<typeof getDocumentWithStages>> | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [stageData, setStageData] = useState<\r\n    Record<string, { works: string[][]; materials: string[][] }>\r\n  >({});\r\n\r\n  const goBack = useCallback(() => {\r\n    const target = (loc.state as { from?: string })?.from || '/estimate';\r\n    window.location.href = target;\r\n  }, [loc.state]);\r\n\r\n  const handlePrint = useCallback(() => {\r\n    window.print();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!validId) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    setError(null);\r\n    getDocumentWithStages(validId)\r\n      .then(async (data) => {\r\n        setDoc(data);\r\n        const stages = data.stages ?? [];\r\n        const next: Record<string, { works: string[][]; materials: string[][] }> = {};\r\n        await Promise.all(\r\n          stages.map(async (s: EstimateStage) => {\r\n            try {\r\n              const [wr, mr] = await Promise.all([\r\n                getSheetByDocKey(validId, buildDocKey(validId, s.id, 'works')),\r\n                getSheetByDocKey(validId, buildDocKey(validId, s.id, 'materials')),\r\n              ]);\r\n              next[s.id] = {\r\n                works: getValues(wr?.snapshot as SheetSnapshot),\r\n                materials: getValues(mr?.snapshot as SheetSnapshot),\r\n              };\r\n            } catch {\r\n              next[s.id] = { works: [], materials: [] };\r\n            }\r\n          }),\r\n        );\r\n        setStageData(next);\r\n      })\r\n      .catch((e: any) => {\r\n        setError(e?.response?.data?.message || 'Помилка завантаження');\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, [validId]);\r\n\r\n  if (!validId) {\r\n    return (\r\n      <Box className=\"estimate-read noprint\">\r\n        <Button startIcon={<ArrowBackIcon />} onClick={() => navigate('/estimate')}>\r\n          Назад\r\n        </Button>\r\n        <Typography color=\"error\" sx={{ mt: 2 }}>\r\n          Невірний ідентифікатор\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  if (loading && !doc) {\r\n    return (\r\n      <Box className=\"estimate-read noprint\">\r\n        <Typography>Завантаження…</Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  if (error && !doc) {\r\n    return (\r\n      <Box className=\"estimate-read noprint\">\r\n        <Button startIcon={<ArrowBackIcon />} onClick={goBack}>\r\n          Назад\r\n        </Button>\r\n        <Typography color=\"error\" sx={{ mt: 2 }}>\r\n          {error}\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  const stages = doc?.stages ?? [];\r\n  const hideCost = false;\r\n\r\n  const agg = stages.reduce(\r\n    (a, s) => {\r\n      const data = stageData[s.id];\r\n      if (!data) return a;\r\n      const rowCountW = Math.max(data.works.length, 1);\r\n      const rowCountM = Math.max(data.materials.length, 1);\r\n      const wt = computeSheetTotals(data.works, rowCountW, W_COL.TOTAL, W_COL.COST_TOTAL, uaLocale);\r\n      const mt = computeSheetTotals(data.materials, rowCountM, M_COL.TOTAL, M_COL.COST_TOTAL, uaLocale);\r\n      a.worksSum += wt.sum;\r\n      a.worksCost += wt.cost;\r\n      a.materialsSum += mt.sum;\r\n      a.materialsCost += mt.cost;\r\n      return a;\r\n    },\r\n    { worksSum: 0, worksCost: 0, materialsSum: 0, materialsCost: 0 },\r\n  );\r\n  const totalSum = agg.worksSum + agg.materialsSum;\r\n  const totalCost = agg.worksCost + agg.materialsCost;\r\n  const totalProfit = totalSum - totalCost;\r\n  const marginPct = totalSum > 0 ? (totalProfit / totalSum) * 100 : 0;\r\n\r\n  return (\r\n    <Box className=\"estimate-read\" sx={{ width: '100%', maxWidth: '100%' }}>\r\n      <Box\r\n        className=\"noprint\"\r\n        sx={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: 1,\r\n          mb: 2,\r\n          flexWrap: 'wrap',\r\n        }}\r\n      >\r\n        <Button size=\"small\" startIcon={<ArrowBackIcon />} onClick={goBack}>\r\n          Назад\r\n        </Button>\r\n        <Typography variant=\"h6\" sx={{ flex: 1 }}>\r\n          {doc?.title ?? `КП #${validId}`} — режим читання\r\n        </Typography>\r\n        <Button size=\"small\" startIcon={<PrintIcon />} variant=\"contained\" onClick={handlePrint}>\r\n          Друк\r\n        </Button>\r\n      </Box>\r\n\r\n      {stages.length > 0 && (\r\n        <Box\r\n          className=\"estimate-read-totals\"\r\n          sx={{\r\n            display: 'flex',\r\n            flexWrap: 'wrap',\r\n            gap: 2,\r\n            p: 1,\r\n            mb: 2,\r\n            borderRadius: 1,\r\n            bgcolor: 'action.hover',\r\n            border: '1px solid',\r\n            borderColor: 'divider',\r\n          }}\r\n        >\r\n          <Typography sx={{ fontSize: 12, fontWeight: 600, color: 'text.secondary', mr: 1 }}>\r\n            Загалом КП\r\n          </Typography>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Роботи:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatUaMoney(agg.worksSum)}</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Матеріали:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatUaMoney(agg.materialsSum)}</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Всього:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatUaMoney(totalSum)}</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Собівартість:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatUaMoney(totalCost)}</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Маржа:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatPercent(marginPct)}</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 0.5, alignItems: 'baseline' }}>\r\n            <Typography sx={{ fontSize: 11, color: 'text.secondary' }}>Прибуток:</Typography>\r\n            <Typography sx={{ fontSize: 13, fontWeight: 600 }}>{formatUaMoney(totalProfit)}</Typography>\r\n          </Box>\r\n        </Box>\r\n      )}\r\n\r\n      {stages.length === 0 ? (\r\n        <Typography color=\"text.secondary\">Немає етапів</Typography>\r\n      ) : (\r\n        stages.map((stage, idx) => {\r\n          const data = stageData[stage.id] ?? { works: [], materials: [] };\r\n          const worksValues = data.works;\r\n          const materialsValues = data.materials;\r\n          const rowCountW = Math.max(worksValues.length, 1);\r\n          const rowCountM = Math.max(materialsValues.length, 1);\r\n          const worksTotals = computeSheetTotals(\r\n            worksValues,\r\n            rowCountW,\r\n            W_COL.TOTAL,\r\n            W_COL.COST_TOTAL,\r\n            uaLocale,\r\n          );\r\n          const materialsTotals = computeSheetTotals(\r\n            materialsValues,\r\n            rowCountM,\r\n            M_COL.TOTAL,\r\n            M_COL.COST_TOTAL,\r\n            uaLocale,\r\n          );\r\n          const stageSum = worksTotals.sum + materialsTotals.sum;\r\n          const stageCost = worksTotals.cost + materialsTotals.cost;\r\n          const stageProfit = stageSum - stageCost;\r\n          const marginPct = stageSum > 0 ? (stageProfit / stageSum) * 100 : 0;\r\n\r\n          const visibleColsW = hideCost ? [0, 1, 2, 3, 4, 5, 8] : [0, 1, 2, 3, 4, 5, 6, 7, 8];\r\n          const visibleColsM = hideCost ? [0, 1, 2, 3, 4, 5, 8] : [0, 1, 2, 3, 4, 5, 6, 7, 8];\r\n          const headersW = worksSheetColumnHeaders.filter((_, i) => visibleColsW.includes(i));\r\n          const headersM = materialsSheetColumnHeaders.filter((_, i) => visibleColsM.includes(i));\r\n\r\n          return (\r\n            <Box\r\n              key={stage.id}\r\n              className=\"estimate-read-stage\"\r\n              sx={{\r\n                breakInside: 'avoid',\r\n                pageBreakInside: 'avoid',\r\n                mb: 3,\r\n                pb: 2,\r\n                borderBottom: '1px solid',\r\n                borderColor: 'divider',\r\n              }}\r\n            >\r\n              <Typography\r\n                variant=\"h6\"\r\n                sx={{\r\n                  mb: 1.5,\r\n                  pb: 0.5,\r\n                  borderBottom: '1px solid',\r\n                  borderColor: 'divider',\r\n                  fontWeight: 600,\r\n                }}\r\n              >\r\n                Етап {idx + 1}: {stage.name}\r\n              </Typography>\r\n\r\n              {/* (1) Works table */}\r\n              <Box sx={{ mb: 2 }}>\r\n                <Typography variant=\"subtitle2\" sx={{ mb: 0.5, fontWeight: 600 }}>\r\n                  Роботи\r\n                </Typography>\r\n                <Box\r\n                  component=\"table\"\r\n                  sx={{\r\n                    width: '100%',\r\n                    borderCollapse: 'collapse',\r\n                    fontSize: 13,\r\n                    '& th, & td': {\r\n                      border: '1px solid',\r\n                      borderColor: 'divider',\r\n                      px: 1,\r\n                      py: 0.5,\r\n                    },\r\n                    '& th': { bgcolor: 'action.hover', fontWeight: 600, textAlign: 'left' },\r\n                    '& td': { verticalAlign: 'top' },\r\n                    '& .num': { textAlign: 'right', fontVariantNumeric: 'tabular-nums' },\r\n                  }}\r\n                >\r\n                  <thead>\r\n                    <tr>\r\n                      {headersW.map((h, i) => (\r\n                        <th key={i} className={[4, 5, 6, 7].includes(visibleColsW[i]) ? 'num' : ''}>\r\n                          {h}\r\n                        </th>\r\n                      ))}\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {worksValues.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan={headersW.length}>—</td>\r\n                      </tr>\r\n                    ) : (\r\n                      worksValues.map((row, ri) => (\r\n                        <tr key={ri}>\r\n                          {visibleColsW.map((c, hi) => (\r\n                            <td\r\n                              key={hi}\r\n                              className={[4, 5, 6, 7].includes(c) ? 'num' : ''}\r\n                            >\r\n                              {row[c] ?? '—'}\r\n                            </td>\r\n                          ))}\r\n                        </tr>\r\n                      ))\r\n                    )}\r\n                  </tbody>\r\n                </Box>\r\n                <Box\r\n                  sx={{\r\n                    display: 'flex',\r\n                    justifyContent: 'flex-end',\r\n                    mt: 0.5,\r\n                    py: 0.75,\r\n                    px: 1,\r\n                    bgcolor: 'action.hover',\r\n                    borderRadius: 0.5,\r\n                    fontSize: 12,\r\n                  }}\r\n                >\r\n                  {hideCost ? (\r\n                    <span>Разом робіт: {formatUaMoney(worksTotals.sum)}</span>\r\n                  ) : (\r\n                    <span>\r\n                      Разом: {formatUaMoney(worksTotals.sum)} · Собівартість:{' '}\r\n                      {formatUaMoney(worksTotals.cost)} · Прибуток: {formatUaMoney(worksTotals.profit)}\r\n                    </span>\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n\r\n              {/* (2) Materials table */}\r\n              <Box>\r\n                <Typography variant=\"subtitle2\" sx={{ mb: 0.5, fontWeight: 600 }}>\r\n                  Матеріали\r\n                </Typography>\r\n                <Box\r\n                  component=\"table\"\r\n                  sx={{\r\n                    width: '100%',\r\n                    borderCollapse: 'collapse',\r\n                    fontSize: 13,\r\n                    '& th, & td': {\r\n                      border: '1px solid',\r\n                      borderColor: 'divider',\r\n                      px: 1,\r\n                      py: 0.5,\r\n                    },\r\n                    '& th': { bgcolor: 'action.hover', fontWeight: 600, textAlign: 'left' },\r\n                    '& td': { verticalAlign: 'top' },\r\n                    '& .num': { textAlign: 'right', fontVariantNumeric: 'tabular-nums' },\r\n                  }}\r\n                >\r\n                  <thead>\r\n                    <tr>\r\n                      {headersM.map((h, i) => (\r\n                        <th key={i} className={[4, 5, 6, 7].includes(visibleColsM[i]) ? 'num' : ''}>\r\n                          {h}\r\n                        </th>\r\n                      ))}\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {materialsValues.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan={headersM.length}>—</td>\r\n                      </tr>\r\n                    ) : (\r\n                      materialsValues.map((row, ri) => (\r\n                        <tr key={ri}>\r\n                          {visibleColsM.map((c, hi) => (\r\n                            <td\r\n                              key={hi}\r\n                              className={[4, 5, 6, 7].includes(c) ? 'num' : ''}\r\n                            >\r\n                              {row[c] ?? '—'}\r\n                            </td>\r\n                          ))}\r\n                        </tr>\r\n                      ))\r\n                    )}\r\n                  </tbody>\r\n                </Box>\r\n                <Box\r\n                  sx={{\r\n                    display: 'flex',\r\n                    justifyContent: 'flex-end',\r\n                    mt: 0.5,\r\n                    py: 0.75,\r\n                    px: 1,\r\n                    bgcolor: 'action.hover',\r\n                    borderRadius: 0.5,\r\n                    fontSize: 12,\r\n                  }}\r\n                >\r\n                  {hideCost ? (\r\n                    <span>Разом матеріалів: {formatUaMoney(materialsTotals.sum)}</span>\r\n                  ) : (\r\n                    <span>\r\n                      Разом: {formatUaMoney(materialsTotals.sum)} · Собівартість:{' '}\r\n                      {formatUaMoney(materialsTotals.cost)} · Прибуток:{' '}\r\n                      {formatUaMoney(materialsTotals.profit)}\r\n                    </span>\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n\r\n              <Box\r\n                sx={{\r\n                  display: 'flex',\r\n                  justifyContent: 'flex-end',\r\n                  mt: 1,\r\n                  py: 0.5,\r\n                  fontSize: 12,\r\n                  color: 'text.secondary',\r\n                }}\r\n              >\r\n                {hideCost ? (\r\n                  <span>Етап: {formatUaMoney(stageSum)}</span>\r\n                ) : (\r\n                  <span>\r\n                    Етап: {formatUaMoney(stageSum)} · Маржа {formatPercent(marginPct)} · Прибуток{' '}\r\n                    {formatUaMoney(stageProfit)}\r\n                  </span>\r\n                )}\r\n              </Box>\r\n            </Box>\r\n          );\r\n        })\r\n      )}\r\n\r\n      <style>{`\r\n        @media print {\r\n          body * { visibility: hidden; }\r\n          .estimate-read, .estimate-read * { visibility: visible; }\r\n          .estimate-read { position: absolute; left: 0; top: 0; width: 100%; padding: 0; }\r\n          .noprint { display: none !important; }\r\n          .estimate-read-stage { break-inside: avoid; page-break-inside: avoid; }\r\n          .boHeader, .boSidebar, [class*=\"AppBar\"], [class*=\"Drawer\"] { display: none !important; }\r\n        }\r\n      `}</style>\r\n    </Box>\r\n  );\r\n};\r\n"],"names":["getValues","snap","row","EstimateReadPage","id","useParams","navigate","useNavigate","loc","useLocation","estimateId","validId","doc","setDoc","useState","loading","setLoading","error","setError","stageData","setStageData","goBack","useCallback","target","handlePrint","useEffect","getDocumentWithStages","data","stages","next","s","wr","mr","getSheetByDocKey","buildDocKey","e","jsxs","Box","jsx","Button","ArrowBackIcon","Typography","agg","rowCountW","rowCountM","wt","computeSheetTotals","W_COL","uaLocale","mt","M_COL","totalSum","totalCost","totalProfit","marginPct","PrintIcon","formatUaMoney","formatPercent","stage","idx","worksValues","materialsValues","worksTotals","materialsTotals","stageSum","stageCost","stageProfit","visibleColsW","visibleColsM","headersW","worksSheetColumnHeaders","_","i","headersM","materialsSheetColumnHeaders","h","ri","c","hi"],"mappings":"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"}